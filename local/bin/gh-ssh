#!/bin/sh

set -e

CODESPACES=$(gh codespace list --json name,repository)
REPO=$(echo $CODESPACES | jq -r '.[] .repository' | gum choose)
CS_NAME=$(echo $CODESPACES | jq -r ".[] | select(.repository == \"$REPO\") | .name")
gh codespace cp --codespace "$CS_NAME" --expand -- -o IdentitiesOnly=yes ~/.local/state/tymek-theme remote:~/.local/state/tymek-theme || echo "Failed to copy /tmp/tymek-theme"
gh codespace ssh --codespace "$CS_NAME" -- -o IdentitiesOnly=yes $@

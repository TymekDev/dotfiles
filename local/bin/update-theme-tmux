#!/bin/sh
update() {
  MODE="$1"
  THEME="$(cat ~/.local/state/tymek-theme/theme || echo 'tokyonight')"
  if [ -z "$MODE" ]; then
    MODE="$(cat ~/.local/state/tymek-theme/mode || echo 'dark')"
  fi

  if [ "$THEME" = "tokyonight" ]; then
    if [ "$MODE" = "light" ]; then
      THEME="tokyonight_day"
    else
      THEME="tokyonight_storm"
    fi

    tmux source "$HOME/.local/share/nvim/lazy/tokyonight.nvim/extras/tmux/$THEME.tmux"
    tmux-prefix-highlight
    return
  fi

  if [ "$THEME" = "rosepine" ]; then
    if [ "$MODE" = "light" ]; then
      THEME="dawn"
    else
      THEME="moon"
    fi

    tmux set -g @rose_pine_variant $THEME
    tmux run ~/.config/tmux/rose-pine/rose-pine.tmux
    return
  fi

  echo "[ERROR] Unknown theme: '$THEME'"
  return 1
}

update "$1"
